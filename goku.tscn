[gd_scene load_steps=25 format=3 uid="uid://bg2ufmmb0wokf"]

[ext_resource type="Texture2D" uid="uid://qqugsev7c35l" path="res://Recursos/Sprites/Prota/Charactert.png" id="1_veywt"]

[sub_resource type="GDScript" id="GDScript_xrcn3"]
script/source = "extends CharacterBody3D

@export var SPEED = 5
@export var JUMP_VELOCITY = 4.5
var dir = Vector2.ZERO
var state_machine

var gravity = ProjectSettings.get_setting(\"physics/3d/default_gravity\")

func _ready():
	$AnimationTree.active = true
	
func _anim():
	
	state_machine = $AnimationTree.get(\"parameters/playback\")
	if Input.is_action_pressed(\"ui_right\"):
		state_machine.travel(\"Correr\")
		$Sprite3D.flip_h = false
			
	elif Input.is_action_pressed(\"ui_left\"):
		state_machine.travel(\"Correr\")
		$Sprite3D.flip_h = true
		
	else:
		state_machine.travel(\"Idle\")
	
	if is_on_floor() == false:
		if velocity.y < 0:
			state_machine.travel(\"salto_caer\")
		else:
			state_machine.travel(\"Salto\")
func _physics_process(delta):
	_anim()
	if not is_on_floor():
		velocity.y -= gravity * delta

	if Input.is_action_just_pressed(\"ui_accept\") and is_on_floor():
		velocity.y = JUMP_VELOCITY

	dir.x = Input.get_action_strength(\"ui_left\") - Input.get_action_strength(\"ui_right\")
	velocity.x = dir.x * SPEED
	move_and_slide()
"

[sub_resource type="BoxShape3D" id="BoxShape3D_kkmuu"]
size = Vector3(0.0849991, 0.293207, 0.103516)

[sub_resource type="Animation" id="Animation_3kpim"]
resource_name = "Idle"
length = 0.8
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite3D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [0, 1, 2, 3]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("CollisionShape3D:position")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0.00715661, 0.0491533, -0.00208966)]
}

[sub_resource type="Animation" id="Animation_t78um"]
resource_name = "Correr"
length = 0.6
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite3D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1),
"update": 1,
"values": [11, 12, 13, 14, 15, 16]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("CollisionShape3D:position")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0.039309, 0.0491533, -0.00208966)]
}

[sub_resource type="Animation" id="Animation_j7sh7"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite3D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [11]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("CollisionShape3D:position")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0.039309, 0.0491533, -0.00208966)]
}

[sub_resource type="Animation" id="Animation_rp6g0"]
resource_name = "Salto"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite3D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.0510523, 0.0998039, 0.160501, 0.222236),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1),
"update": 1,
"values": [18, 19, 20, 21, 22]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("CollisionShape3D:position")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.3),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(0.039309, 0.048536, -0.00208966), Vector3(0.039309, 0.145218, -0.00208966)]
}

[sub_resource type="Animation" id="Animation_6y8xx"]
resource_name = "salto_caer"
length = 0.2
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite3D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [22, 23]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("CollisionShape3D:position")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0.039309, 0.125446, -0.00208966)]
}

[sub_resource type="Animation" id="Animation_0nl2m"]
resource_name = "damage"
length = 0.3
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite3D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 1,
"values": [25, 26, 27]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_onaq2"]
_data = {
"Correr": SubResource("Animation_t78um"),
"Idle": SubResource("Animation_3kpim"),
"RESET": SubResource("Animation_j7sh7"),
"Salto": SubResource("Animation_rp6g0"),
"damage": SubResource("Animation_0nl2m"),
"salto_caer": SubResource("Animation_6y8xx")
}

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_sg16l"]
animation = &"Correr"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_oocto"]
animation = &"Idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_fhvl7"]
animation = &"Salto"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ltbcw"]
animation = &"salto_caer"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_0dw1g"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_tvrxt"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_v5bvk"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ecmbp"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_hfcg8"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_25pg2"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_hom7t"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_46kyp"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_6j3gx"]

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_uw6ge"]
states/Correr/node = SubResource("AnimationNodeAnimation_sg16l")
states/Correr/position = Vector2(530, 100)
states/Idle/node = SubResource("AnimationNodeAnimation_oocto")
states/Idle/position = Vector2(339, 100)
states/Salto/node = SubResource("AnimationNodeAnimation_fhvl7")
states/Salto/position = Vector2(391, 2)
states/salto_caer/node = SubResource("AnimationNodeAnimation_ltbcw")
states/salto_caer/position = Vector2(559, 2)
transitions = ["Start", "Idle", SubResource("AnimationNodeStateMachineTransition_0dw1g"), "Idle", "Salto", SubResource("AnimationNodeStateMachineTransition_tvrxt"), "Salto", "salto_caer", SubResource("AnimationNodeStateMachineTransition_v5bvk"), "salto_caer", "Correr", SubResource("AnimationNodeStateMachineTransition_ecmbp"), "Correr", "Idle", SubResource("AnimationNodeStateMachineTransition_hfcg8"), "Idle", "Correr", SubResource("AnimationNodeStateMachineTransition_25pg2"), "Salto", "Idle", SubResource("AnimationNodeStateMachineTransition_hom7t"), "salto_caer", "Salto", SubResource("AnimationNodeStateMachineTransition_46kyp"), "Correr", "salto_caer", SubResource("AnimationNodeStateMachineTransition_6j3gx")]
graph_offset = Vector2(-51, -66)

[node name="Goku" type="CharacterBody3D"]
script = SubResource("GDScript_xrcn3")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.039309, 0.0491533, -0.00208966)
shape = SubResource("BoxShape3D_kkmuu")

[node name="Sprite3D" type="Sprite3D" parent="."]
transform = Transform3D(1.2, 0, 0, 0, 1.2, 0, 0, 0, 1.2, 0, 0.16447, 0)
texture_filter = 4
texture = ExtResource("1_veywt")
hframes = 19
vframes = 5
frame = 11

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
"": SubResource("AnimationLibrary_onaq2")
}

[node name="AnimationTree" type="AnimationTree" parent="."]
active = false
libraries = {
"": SubResource("AnimationLibrary_onaq2")
}
tree_root = SubResource("AnimationNodeStateMachine_uw6ge")
anim_player = NodePath("../AnimationPlayer")
